TODO:
  * The worker should have more abstraction and shouldn't deal with the NSQ connection

